<!DOCTYPE html> 
<html>
	<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1"> 
	<title>Tapestry5 Portlet - How to</title> 
	<link rel="stylesheet"  href="../../css/themes/default/jquery.mobile-1.2.0.css" /> 
	<link rel="stylesheet" href="../_assets/css/jqm-docs.css"/>

	<script src="../../js/jquery.js"></script>
	<script src="../../docs/_assets/js/jqm-docs.js"></script>
	<script src="../../js/jquery.mobile-1.2.0.js"></script>

</head> 
<body> 

<div data-role="page" class="type-interior">

	<div data-role="header" data-theme="f">
		<h1>How to</h1>
		<a href="../../" data-icon="home" data-iconpos="notext" data-direction="reverse">Home</a>
		<a href="../nav.html" data-icon="search" data-iconpos="notext" data-rel="dialog" data-transition="fade">Search</a>
	</div><!-- /header -->

	<div data-role="content">
		
	<div class="content-primary">
	
	<h2>Use tapestry-Liferay instead of tapestry5-portlet</h2>

	<p>If you want to use Liferay api, it would be better to use https://github.com/got5/tapestry5-liferay
	This is module will help you to fill the gap between portlet JSR and liferay implemenation. 
	this lib come with a sub module that can be used as a demo see 
	https://github.com/got5/tapestry5-liferay/tree/master/tapestry-liferay-demo.</p>

<textarea readonly="readonly">
...
	<dependency>
		<groupId>org.apache.tapestry</groupId>
		<artifactId>tapestry-liferay</artifactId>
		<version>${tapestry-portlet-version}</version>
	</dependency>

	<dependency>
		<groupId>org.apache.tapestry</groupId>
		<artifactId>tapestry5-portlet</artifactId>
		<version>${tapestry-portlet-version}</version>
	</dependency>
...
</textarea>
		
	<h2>Deploying on LiferayOnce</h2>

	<p>Once Liferay is unpacked on your system, you simply have to run the server. 
	To deploy your application on this running Liferay instance, 
	simply change the build path of your war file by configuring the maven war plugin.</p>

<textarea readonly="readonly">
<plugin>
  <groupId>org.apache.maven.plugins</groupId>
  <artifactId>maven-war-plugin</artifactId>--
  <version>2.1.1</version>
  <configuration>
    <warName>${project.artifactId}</warName>
    <outputDirectory>${outputDirectory}</outputDirectory>
    <archive>
        <manifestEntries>   
            <tapestry-Module-Classes>
                net.atos.porlet.AppModule
            </tapestry-Module-Classes>
        </manifestEntries>
    </archive>
  </configuration>
</plugin>
</textarea>

	<p>By doing this, you will be able to generate the war file directly in the "deploy" directory of your liferay installation. Once the file is copied in this directory, Liferay will hot deploy it. 
	  We also have to define the Module Class of our portlet, in order to load it.</p>		

<textarea readonly="readonly">
<properties>
  <tapestry-release-version>5.3.6</tapestry-release-version>
  <outputDirectory>D:/liferay-portal-6.1.1/deploy</outputDirectory>
</properties></textarea>
		
		<p>Note that the "outputDirectory" must be declared in the "properties" section of your pom.xml file</p>
		
		<h2>liferay-portlet.xml</h2>
		
		<p>As many implementors Liferay Portal has its own features and behaviours.
		The "liferay-portlet.xml" file allows you to configure those. In case of Tapestry portlet integration, 
		you will have to specify some of them to integrate well with Tapestry. Have a look at the snippet below:</p>
		
<textarea readonly="readonly">
<?xml version="1.0"?>
<!DOCTYPE liferay-portlet-app PUBLIC "-//Liferay//DTD Portlet Application 5.2.0//EN" "http://www.liferay.com/dtd/liferay-portlet-app_5_2_0.dtd">
<liferay-portlet-app>
  <portlet>
    <portlet-name>TapestryPortlet</portlet-name>
    <action-url-redirect>true</action-url-redirect>
    <instanceable>true</instanceable>
    <private-request-attributes>false</private-request-attributes>
  </portlet>
</liferay-portlet-app></textarea>

		<p>Every portlet declared in the "portlet.xml" must match one element in this document. 
		Also the "portlet-name" must match a corresponding portlet in portlet.xml.</p>

		<p>Set the "action-url-redirect" to true, this is important to enable the redirect-after-post behaviour. 
		By default, Liferay will not redirect the user after an action request but will simply launch render request in the same thread. 
		This behaviour is not consistent with Tapestry’s design because it can lead to double-submit problem on page refresh.
		</p>

		<p>Set the "instanceable" to true if you need to instantiate more than once per page.</p>

 		<p>Important: set the "private-request-attributes" to false will allow the portlet to share request 
 		attributes with others.This will allow us to handle JS and CSS includes properly within the portal page "head" part.
 		Without this property set to false, you may have duplicate resources in the body of the containing portal page.</p>

		
				
		</div><!--/content-primary -->		
		
		<div class="content-secondary">
			
			<div data-role="collapsible" data-collapsed="true" data-theme="b" data-content-theme="d">
				
					<h3>More in this section</h3>
					
					<ul data-role="listview"  data-theme="c" data-dividertheme="d">
						<li data-role="list-divider">Liferay Integration</li>
						<li data-theme="a"><a href="../../faq/liferay/Liferay.html">Liferay Integration</a></li>	
						<li><a href="../../faq/liferay/Liferay-cache.html">Liferay Caching</a></li>
						
				
					</ul>
			</div>
		</div>		

	</div><!-- /content -->
	
	<div data-role="footer" class="footer-docs" data-theme="c">
		<p class="jqm-version"></p>
		<p>&copy; 2012 jQuery Foundation and other contributors</p>
	</div>	
	
	
</div><!-- /page -->

</body>
</html>
