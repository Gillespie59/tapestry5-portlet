<!DOCTYPE html> 
<html>
	<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1"> 
	<title>Tapestry5 Portlet - SessionState</title> 
	<link rel="stylesheet"  href="../../css/themes/default/jquery.mobile-1.2.0.css" /> 
	<link rel="stylesheet" href="../_assets/css/jqm-docs.css"/>

	<script src="../../js/jquery.js"></script>
	<script src="../../docs/_assets/js/jqm-docs.js"></script>
	<script src="../../js/jquery.mobile-1.2.0.js"></script>

</head> 
<body> 

<div data-role="page" class="type-interior">

	<div data-role="header" data-theme="f">
		<h1>SessionState in PortletSession </h1>
		<a href="../../" data-icon="home" data-iconpos="notext" data-direction="reverse">Home</a>
		<a href="../nav.html" data-icon="search" data-iconpos="notext" data-rel="dialog" data-transition="fade">Search</a>
	</div><!-- /header -->

	<div data-role="content">
	
	<p>
		<i>Examples about portlet communication are available in <a href="https://github.com/got5/tapestry5-liferay/tree/master/tapestry-liferay-demo">tapestry-liferay-demo</a> project (see <a href="https://github.com/got5/tapestry5-liferay/blob/master/tapestry-liferay-demo/src/main/java/tapestry/liferay/portlets/pages/kawwa2/Basket.java">Basket</a> and <a href="https://github.com/got5/tapestry5-liferay/blob/master/tapestry-liferay-demo/src/main/java/tapestry/liferay/portlets/pages/kawwa2/Catalog.java">Catalog</a> portlets).</i>
	</p>
		
	<h2>SessionState in PortletSession</h2>
		
	<p>Making page data persist across requests among every page of your application is accomplished with the <i>@SessionState</i> annotation. 
	This annotation is applied to private instance fields of components:</p>

		
<textarea readonly="readonly">
@SessionState
private User currentUser;
</textarea> 

	<p>
		The value of a session state object is stored in the session, and is global to all application pages for the same user. Any page or component that wants to use this object has to declare a field of the same type, with <i>@SessionState</i> annotation.
	</p>
	
	<p>
		In portlet world, default scope for session state objects is <i>PORTLET_SCOPE</i>. It means that your object will be persisted, but only in the scope of the porlet. It won't be shared in the others portlets of your application.
		<br/>
		<i>For example, if your page displays two porlets, A and B, and if portlet A edits the value of a session state object, the porlet B won't be aware of these modifications.</i>
	</p>
	
	<p>
		If you want to share an object among all portlets in your application, you will have to set another persistence strategy for Session State objects in order to use the <i>APPLICATION_SCOPE</i>.
		<br/>
		To define a new persistence strategy for a given object in your application, use the method <i>contributeApplicationStateManager</i> in your application module:
	</p>
       
<textarea readonly="readonly">
public void contributeApplicationStateManager(MappedConfiguration<Class, ApplicationStateContribution> configuration)
{
    ApplicationStateCreator<User> creator = new ApplicationStateCreator<User>()
    {
        public User create()
        {
          return new User();
        }
    };
	
	//Application scope used for User object persistence.
	configuration.add(User.class, new ApplicationStateContribution(PortletPersistenceConstants.PORTLET_SESSION_APPLICATION_SCOPE, creator));
}
</textarea>  
      		
	<div data-role="collapsible" data-collapsed="true" data-theme="b" data-content-theme="d">
				
		<h3>More in this section</h3>
					
		<ul data-role="listview"  data-theme="c" data-dividertheme="d">
			<li><a href="../../docs/features/persist.html">Persist</a></li>
			<li><a href="../../docs/features/portletCommunication.html">portletCommunication</a></li>	
		</ul>
	</div>	
		

	</div>
	
	<div data-role="footer" class="footer-docs" data-theme="c">
		<p class="jqm-version"></p>
		<p>&copy; 2012 jQuery Foundation and other contributors</p>
	</div>	
	
	
</div>

</body>
</html>
